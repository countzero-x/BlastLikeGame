window.__require=function e(t,o,i){function r(s,c){if(!o[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var u="function"==typeof __require&&__require;if(!c&&u)return u(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var l=o[s]={exports:{}};t[s][0].call(l.exports,function(e){return r(t[s][1][e]||e)},l,l.exports,e,t,o,i)}return o[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<i.length;s++)r(i[s]);return r}({BlastGameMediator:[function(e,t,o){"use strict";cc._RF.push(t,"ab27dW9aNxP8ZRmZkrg9V0+","BlastGameMediator"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlastGameMediator=void 0;var i=e("../GameEvent"),r=e("./enums/BoosterType"),n=function(){function e(e){var t=this;this.onStateChanged=new i.GameEvent,this.onInputStateChanged=new i.GameEvent,this.onTurnFinished=new i.GameEvent,this.onGameStarted=new i.GameEvent,this.onGameFinished=new i.GameEvent,this.onBoosterTypeChanged=new i.GameEvent,this.onBoosterCountChanged=new i.GameEvent,this.onBoosterSelected=new i.GameEvent,this.onBoosterDeselected=new i.GameEvent,this._game=e,this._game.onStateChanged.subscribe(function(e){return t.onStateChanged.invoke(e)},this),this._game.onInputStateChanged.subscribe(function(e){return t.onInputStateChanged.invoke(e)},this),this._game.onTurnFinished.subscribe(function(e){return t.onTurnFinished.invoke(e)},this),this._game.onGameStarted.subscribe(function(e){return t.onGameStarted.invoke(e)},this),this._game.onGameFinished.subscribe(function(e){return t.onGameFinished.invoke(e)},this),this._game.onBoosterTypeChanged.subscribe(function(e){return t.onBoosterTypeChanged.invoke(e)},this),this._game.onBoosterSelected.subscribe(function(e){return t.onBoosterSelected.invoke(e)},this),this._game.onBoosterDeselected.subscribe(function(e){return t.onBoosterDeselected.invoke(e)},this),this._game.onBoosterTypeChanged.subscribe(function(e){var o,i=t._game.boosters.getBooster(e);t.onBoosterCountChanged.invoke({type:e,count:null!==(o=null==i?void 0:i.getCount())&&void 0!==o?o:0})},this);for(var o=function(e){e.onCountChanged.subscribe(function(o){return t.onBoosterCountChanged.invoke({type:e.type,count:o})},r)},r=this,n=0,s=this._game.boosters.boosters;n<s.length;n++)o(s[n])}return e.prototype.startGame=function(){this._game.start()},e.prototype.finishGame=function(){this._game.finish()},e.prototype.enableInput=function(){this._game.input.enable()},e.prototype.disableInput=function(){this._game.input.disable()},e.prototype.click=function(e,t){this._game.processTurn(e,t)},e.prototype.getBoardWidth=function(){return this._game.board.width},e.prototype.getBoardHeight=function(){return this._game.board.height},e.prototype.getTile=function(e,t){return this._game.board.getTile(e,t)},e.prototype.getCurrentScore=function(){return this._game.score.currentScore},e.prototype.getTargetScore=function(){return this._game.score.targetScore},e.prototype.getMovesCount=function(){return this._game.moves.currentMoves},e.prototype.canSelectBooster=function(e){return this._game.boosters.canApply(e)},e.prototype.selectBooster=function(e){this._game.selectBooster(e)},e.prototype.deselectBooster=function(){this._game.deselectBooster(r.BoosterType.NONE)},e.prototype.getBoosterCount=function(e){return this._game.boosters.getBooster(e).getCount()},e.prototype.getSelectedBoosterType=function(){return this._game.boosters.selectedType},e}();o.BlastGameMediator=n,cc._RF.pop()},{"../GameEvent":"GameEvent","./enums/BoosterType":"BoosterType"}],BlastGame:[function(e,t,o){"use strict";cc._RF.push(t,"1bb97YsETRMy5ys8C6Ls5Mj","BlastGame"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlastGame=void 0;var i=e("../GameEvent"),r=e("./enums/GameState"),n=e("./enums/InputState"),s=e("./enums/BoosterType"),c=function(){function e(e,t,o,s,c,a,u,l,p,f,h,d,y,v,T,_){var m=this;this.onStateChanged=new i.GameEvent,this.onInputStateChanged=new i.GameEvent,this.onTurnFinished=new i.GameEvent,this.onGameStarted=new i.GameEvent,this.onGameFinished=new i.GameEvent,this.onBoosterTypeChanged=new i.GameEvent,this.onBoosterSelected=new i.GameEvent,this.onBoosterDeselected=new i.GameEvent,this._state=r.GameState.GAME,this._inputState=n.InputState.NORMAL,this.input=e,this.board=t,this.score=o,this.moves=s,this.spawner=c,this.shuffle=a,this.matches=u,this.gravity=l,this.superTiles=p,this.boosters=f,this._lastTurnContext=this.createTurnCtx(),this._preGameProcessors=h,this._postGameProcessors=d,this._preTurnProcessors=y,this._clickProcessors=v,this._postTurnProcessors=T,this._tileRemovedProcessors=_,this.boosters.init(this),this.boosters.onSelectedTypeChanged.subscribe(function(e){return m.onBoosterTypeChanged.invoke(e)},this)}return Object.defineProperty(e.prototype,"lastTurnContext",{get:function(){return this._lastTurnContext},enumerable:!1,configurable:!0}),e.prototype.getState=function(){return this._state},e.prototype.getInputState=function(){return this._inputState},e.prototype.setInputState=function(e){this._inputState=e,this.onInputStateChanged.invoke(this._inputState)},e.prototype.start=function(){for(var e=new Array,t=0,o=this._preGameProcessors;t<o.length;t++){var i=o[t];e.push(i.onPreGame(this))}this.onGameStarted.invoke(e)},e.prototype.finish=function(){for(var e=new Array,t=0,o=this._postGameProcessors;t<o.length;t++){var i=o[t];e.push(i.onPostGame(this))}this.onGameFinished.invoke(e),this.reset()},e.prototype.selectBooster=function(e){var t=new Array;this.boosters.apply(e),t.push(this.boosters.onBoosterSelected()),this.onBoosterSelected.invoke(t)},e.prototype.deselectBooster=function(){var e=new Array;e.push(this.boosters.onBoosterDeselected()),this.boosters.apply(s.BoosterType.NONE),this.onBoosterDeselected.invoke(e)},e.prototype.processTurn=function(e,t){if(this.input.isEnabled){this._lastTurnContext=this.createTurnCtx();var o=this.board.getTile(e,t);if(o&&!o.isEmpty){this._lastTurnContext.selectedTile=o;for(var i=new Array,r=0,n=this._preTurnProcessors;r<n.length;r++){var s=n[r];s.canProcess(this._lastTurnContext)&&i.push(s.onPreTurn(this._lastTurnContext))}for(var c=0,a=this._clickProcessors;c<a.length;c++){var u=a[c];u.canProcess(this._lastTurnContext)&&i.push(u.onTileClick(this._lastTurnContext))}for(var l=0,p=Array.from(this._lastTurnContext.tilesToRemove);l<p.length;l++){var f=p[l];this.board.removeTile(f)}for(var h=0,d=this._tileRemovedProcessors;h<d.length;h++){var y=d[h];y.canProcess(this._lastTurnContext)&&i.push(y.onTileRemoved(this._lastTurnContext))}for(var v=0,T=this._postTurnProcessors;v<T.length;v++){var _=T[v];_.canProcess(this._lastTurnContext)&&i.push(_.onPostTurn(this._lastTurnContext))}this.onTurnFinished.invoke(i)}}},e.prototype.reset=function(){this.setInputState(n.InputState.NORMAL),this._lastTurnContext=null,this.score.reset(),this.moves.reset(),this.boosters.reset(),this.board.clear()},e.prototype.setState=function(e){this._state=e,this.onStateChanged.invoke(this._state)},e.prototype.createTurnCtx=function(){return{getState:this.getState.bind(this),setState:this.setState.bind(this),getInputState:this.getInputState.bind(this),setInputState:this.setInputState.bind(this),selectedTile:null,spawner:this.spawner,board:this.board,matches:this.matches,initialRemovedCount:0,tilesToRemove:new Set,tilesToCreate:new Set}},e}();o.BlastGame=c,cc._RF.pop()},{"../GameEvent":"GameEvent","./enums/BoosterType":"BoosterType","./enums/GameState":"GameState","./enums/InputState":"InputState"}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"ccdd2EI3lROVpmUTBoeVb+M","BoardView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardView=void 0;var s=cc._decorator,c=s.ccclass,a=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tileViews=[],t}return r(t,e),t.prototype.init=function(e,t,o,i){this._tileViewPool=t,this._mediator=e,this._tileSize=o,this._tileSpacing=i;for(var r=0;r<this._mediator.getBoardWidth();r++){this._tileViews[r]=[];for(var n=0;n<this._mediator.getBoardHeight();n++)this._tileViews[r][n]=null}},t.prototype.onEnable=function(){this.clickNode.on(cc.Node.EventType.TOUCH_END,this.onTouch,this)},t.prototype.onDisable=function(){this.clickNode.off(cc.Node.EventType.TOUCH_END,this.onTouch,this)},t.prototype.getTileView=function(e,t){return e>=0&&e<this._mediator.getBoardWidth()&&t>=0&&t<this._mediator.getBoardHeight()?this._tileViews[e][t]:null},t.prototype.reset=function(){for(var e=0;e<this._mediator.getBoardWidth();e++){this._tileViews[e]=[];for(var t=0;t<this._mediator.getBoardHeight();t++)null!=this._tileViews[e][t]&&this._tileViewPool.put(this._tileViews[e][t]),this._tileViews[e][t]=null}},t.prototype.onTouch=function(e){var t=e.getLocation(),o=this.worldToGridPos(t);this.isValidPosition(o.x,o.y)&&this._mediator.click(o.x,o.y)},t.prototype.isValidPosition=function(e,t){return e>=0&&e<this._mediator.getBoardWidth()&&t>=0&&t<this._mediator.getBoardHeight()},t.prototype.createTileView=function(e){if(null==e)return null;var t=this._tileViewPool.get(e);return t.node.position=this.gridToWorldPos(e.x,e.y),this.tiles.addChild(t.node),t},t.prototype.gridToWorldPos=function(e,t){var o=-this._mediator.getBoardWidth()*(this._tileSize+this._tileSpacing)/2+this._tileSize/2,i=-this._mediator.getBoardHeight()*(this._tileSize+this._tileSpacing)/2+this._tileSize/2;return cc.v3(o+e*(this._tileSize+this._tileSpacing),i+t*(this._tileSize+this._tileSpacing),0)},t.prototype.worldToGridPos=function(e){var t=this.tiles.convertToNodeSpaceAR(e),o=-this._mediator.getBoardWidth()*(this._tileSize+this._tileSpacing)/2+this._tileSize/2,i=-this._mediator.getBoardHeight()*(this._tileSize+this._tileSpacing)/2+this._tileSize/2;return{x:Math.floor((t.x-o+this._tileSize/2)/(this._tileSize+this._tileSpacing)),y:Math.floor((t.y-i+this._tileSize/2)/(this._tileSize+this._tileSpacing))}},t.prototype.animateTileRemoval=function(e){var t=this;return new Promise(function(o){if(0!==e.length)for(var i=0,r=function(r){var n=t.getTileView(r.x,r.y);n?n.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,0),cc.fadeOut(.3)),cc.callFunc(function(){t._tileViews[r.x][r.y]=null,t._tileViewPool.put(n),++i===e.length&&o()}))):++i===e.length&&o()},n=0,s=e;n<s.length;n++)r(s[n]);else o()})},t.prototype.animateSuperTileCreation=function(e){var t=this;return new Promise(function(o){if(e){var i=e.x,r=e.y,n=t.createTileView(e);t._tileViews[i][r]=n,n?(n.node.scale=0,n.node.runAction(cc.sequence(cc.spawn(cc.fadeIn(.12),cc.scaleTo(.12,1).easing(cc.easeBackOut())),cc.callFunc(function(){o()})))):o()}else o()})},t.prototype.animateGravity=function(e){var t=this;return new Promise(function(o){if(e&&0!==e.length){var i=0;e.forEach(function(r){var n=t._tileViews[r.x][r.fromY];if(n){t._tileViews[r.x][r.fromY]=null;var s=t._mediator.getTile(r.x,r.toY);s&&(t._tileViews[r.x][r.toY]=n,cc.log("  \u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d \u0432\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u0438\u0439 tile TileView: ("+s.x+", "+s.y+")"));var c=t.gridToWorldPos(r.x,r.toY);n.node.runAction(cc.sequence(cc.moveTo(.1,c.x,c.y).easing(cc.easeIn(2)),cc.callFunc(function(){++i===e.length&&o()})))}else++i===e.length&&o()})}else o()})},t.prototype.animateHideTiles=function(){var e=this;return new Promise(function(t){if(0!==e._tileViews.length)for(var o=0,i=Math.floor(e._mediator.getBoardWidth()/2),r=Math.floor(e._mediator.getBoardHeight()/2),n=0;n<e._mediator.getBoardWidth();n++)for(var s=0;s<e._mediator.getBoardHeight();s++){var c=e.getTileView(n,s);if(c){var a=.05*(Math.abs(n-i)+Math.abs(s-r));c.node.runAction(cc.sequence(cc.delayTime(a),cc.spawn(cc.scaleTo(.4,0).easing(cc.easeIn(2)),cc.fadeOut(.4),cc.rotateBy(.4,180)),cc.callFunc(function(){++o==e._tileViews.length&&t()})))}}else t()})},t.prototype.animateNewTiles=function(e){var t=this;return new Promise(function(o){if(0!==e.length)for(var i=0,r=0,n=e;r<n.length;r++){var s=n[r],c=t.createTileView(s);if(t._tileViews[s.x][s.y]=c,c){var a=t.gridToWorldPos(s.x,s.y),u=cc.v3(a.x,a.y+t._mediator.getBoardHeight()*(t._tileSize+t._tileSpacing));c.node.position=u,c.node.opacity=0,c.node.runAction(cc.sequence(cc.spawn(cc.moveTo(.4,cc.v2(a)).easing(cc.easeBounceOut()),cc.fadeIn(.12),cc.scaleTo(.12,1)),cc.callFunc(function(){++i===e.length&&o()})))}else++i===e.length&&o()}else o()})},t.prototype.animateTileSwap=function(e,t){var o=this;return new Promise(function(i){var r=o.getTileView(e.x,e.y),n=o.getTileView(t.x,t.y);if(r&&n){var s=0,c=function(){2==++s&&i()};r.node.runAction(cc.sequence(cc.scaleTo(.15,0).easing(cc.easeIn(2)),cc.callFunc(function(){var e=o.gridToWorldPos(t.x,t.y);r.node.position=e,o._tileViews[t.x][t.y]=r}),cc.scaleTo(.15,1).easing(cc.easeOut(2)),cc.callFunc(c))),n.node.runAction(cc.sequence(cc.scaleTo(.15,0).easing(cc.easeIn(2)),cc.callFunc(function(){var t=o.gridToWorldPos(e.x,e.y);n.node.position=t,o._tileViews[e.x][e.y]=n}),cc.scaleTo(.15,1).easing(cc.easeOut(2)),cc.callFunc(c)))}else i()})},t.prototype.animateShuffle=function(){var e=this;return new Promise(function(t){if(0!==e._tileViews.length){for(var o=0,i=0,r=0,n=e._tileViews;r<n.length;r++){var s=n[r];i+=s.length}for(var c=0,a=e._tileViews;c<a.length;c++)for(var u=0,l=s=a[c];u<l.length;u++){var p=l[u];p?p.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.25,0).easing(cc.easeIn(2)),cc.rotateBy(.25,180),cc.fadeOut(.25)),cc.callFunc(function(){if(++o===i){for(var r=0;r<e._mediator.getBoardWidth();r++)for(var n=0;n<e._mediator.getBoardHeight();n++){var s=e.getTileView(r,n),c=e._mediator.getTile(r,n);s&&c&&(s.node.scale=0,s.node.opacity=0,s.node.rotation=0)}var a=[];for(r=0;r<e._mediator.getBoardWidth();r++)for(n=0;n<e._mediator.getBoardHeight();n++)(s=e.getTileView(r,n))&&a.push(s);for(var u=0,l=0,p=a;l<p.length;l++){s=p[l];var f=.3*Math.random();s.node.runAction(cc.sequence(cc.delayTime(f),cc.spawn(cc.scaleTo(.25,1).easing(cc.easeBackOut()),cc.fadeIn(.25)),cc.callFunc(function(){++u===a.length&&t()})))}}}))):o++}}else t()})},n([a(cc.Node)],t.prototype,"tiles",void 0),n([a(cc.Node)],t.prototype,"clickNode",void 0),n([c],t)}(cc.Component);o.BoardView=u,cc._RF.pop()},{}],Board:[function(e,t,o){"use strict";cc._RF.push(t,"98f8bm/VhNL0at9McS5982c","Board"),Object.defineProperty(o,"__esModule",{value:!0}),o.Board=void 0;var i=function(){function e(e,t){this.width=e,this.height=t,this.tiles=new Map}return e.prototype.getTile=function(e,t){if(this.isValidPosition(e,t))return this.tiles.get(this.getKey(e,t))},e.prototype.setTile=function(e,t,o){this.validatePosition(e,t),this.tiles.set(this.getKey(e,t),o)},e.prototype.swapTiles=function(e,t){var o={x:e.x,y:e.y},i={x:t.x,y:t.y};this.validatePosition(o.x,o.y),this.validatePosition(i.x,i.y),e.setPosition(i.x,i.y),t.setPosition(o.x,o.y),this.tiles.set(this.getKey(i.x,i.y),e),this.tiles.set(this.getKey(o.x,o.y),t)},e.prototype.removeTiles=function(e){for(var t=0,o=e;t<o.length;t++){var i=o[t];this.removeTileByPosition(i.x,i.y)}},e.prototype.removeTile=function(e){this.removeTileByPosition(e.x,e.y)},e.prototype.removeTileByPosition=function(e,t){this.isValidPosition(e,t)&&this.tiles.delete(this.getKey(e,t))},e.prototype.hasTile=function(e,t){return!!this.isValidPosition(e,t)&&this.tiles.has(this.getKey(e,t))},e.prototype.isEmpty=function(e,t){var o=this.getTile(e,t);return!o||o.isEmpty},e.prototype.isValidPosition=function(e,t){return e>=0&&e<this.width&&t>=0&&t<this.height},e.prototype.getAllTiles=function(){return Array.from(this.tiles.values())},e.prototype.clear=function(){this.tiles.clear()},e.prototype.getKey=function(e,t){return t*this.width+e},e.prototype.validatePosition=function(e,t){if(!this.isValidPosition(e,t))throw new Error("Position out of bounds: ("+e+", "+t+"). Valid range: 0-"+(this.width-1)+", 0-"+(this.height-1))},e}();o.Board=i,cc._RF.pop()},{}],BombBooster:[function(e,t,o){"use strict";cc._RF.push(t,"ada81jumdFOk5U9KhtMv8px","BombBooster"),Object.defineProperty(o,"__esModule",{value:!0}),o.BombBooster=void 0;var i=e("../../../GameEvent"),r=e("../../enums/BoosterType"),n=e("../../enums/InputState"),s=e("../effects/DestroyEffect"),c=function(){function e(e,t){this.type=r.BoosterType.BOMB,this.initialInputState=n.InputState.BOMB,this.onCountChanged=new i.GameEvent,this._maxCount=e,this._radius=t,this._count=e}return e.prototype.canProcess=function(){return this.canUse()},e.prototype.onBoosterSelected=function(){return null},e.prototype.onBoosterDeselected=function(){return null},e.prototype.onTileClick=function(e){if(!this.canUse())return[];for(var t=this.getBombAffectedTiles(e.selectedTile,e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.tilesToRemove.add(r)}this.setCount(this._count-1),e.setInputState(n.InputState.NORMAL);var c=new s.DestroyEffect;return c.tilesToRemove=t,c},e.prototype.getCount=function(){return this._count},e.prototype.canUse=function(){return this._count>0},e.prototype.reset=function(){this.setCount(this._maxCount)},e.prototype.getBombAffectedTiles=function(e,t){for(var o=[],i=this._radius*this._radius,r=-this._radius;r<=this._radius;r++)for(var n=-this._radius;n<=this._radius;n++)if(!(r*r+n*n>i)){var s=t.getTile(e.x+r,e.y+n);0==(null==s?void 0:s.isEmpty)&&o.push(s)}return o},e.prototype.setCount=function(e){this._count=e,this.onCountChanged.invoke(this._count)},e}();o.BombBooster=c,cc._RF.pop()},{"../../../GameEvent":"GameEvent","../../enums/BoosterType":"BoosterType","../../enums/InputState":"InputState","../effects/DestroyEffect":"DestroyEffect"}],BoosterType:[function(e,t,o){"use strict";cc._RF.push(t,"da25f6r2ZBP9bFfhxymWGTx","BoosterType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterType=void 0,function(e){e[e.TELEPORT=0]="TELEPORT",e[e.BOMB=1]="BOMB",e[e.NONE=-1]="NONE"}(o.BoosterType||(o.BoosterType={})),cc._RF.pop()},{}],BoosterView:[function(e,t,o){"use strict";cc._RF.push(t,"12c37DX555I7JcHLrXdSpe9","BoosterView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterView=void 0;var s=cc._decorator,c=s.ccclass,a=s.property,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),t.prototype.init=function(e,t){this._mediator=e,this._type=t,this._mediator.onBoosterCountChanged.subscribe(this.handleCountChanged,this),this._mediator.onBoosterTypeChanged.subscribe(this.handleTypeChanged,this),this.handleCountChanged({type:this._type,count:this._mediator.getBoosterCount(this.type)}),this.button.node.on("click",this.handleClicked.bind(this))},t.prototype.handleClicked=function(){this._mediator.getSelectedBoosterType()==this.type?this._mediator.deselectBooster(this.type):this._mediator.canSelectBooster(this.type)&&this._mediator.selectBooster(this.type)},t.prototype.handleCountChanged=function(e){e.type==this.type&&(this.label.string=e.count.toString(),this.button.interactable=this._mediator.canSelectBooster(this.type))},t.prototype.handleTypeChanged=function(e){this.animateBoosterActive(this._type==e)},t.prototype.animateBoosterActive=function(e){var t=e?1.2:1,o=e?cc.Color.YELLOW:cc.Color.WHITE;this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.scaleTo(.2,t),cc.tintTo(.2,o.r,o.g,o.b))),e&&this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.3),cc.scaleTo(.5,1.2))))},n([a(cc.Label)],t.prototype,"label",void 0),n([a(cc.Button)],t.prototype,"button",void 0),n([c],t)}(cc.Component);o.BoosterView=u,cc._RF.pop()},{}],Boosters:[function(e,t,o){"use strict";cc._RF.push(t,"8f115Ic2opEIJHHTG5DK/mN","Boosters"),Object.defineProperty(o,"__esModule",{value:!0}),o.Boosters=void 0;var i=e("../../GameEvent"),r=e("../enums/BoosterType"),n=e("../enums/InputState"),s=function(){function e(){this._boosters=new Map,this._selectedType=r.BoosterType.NONE,this.onSelectedTypeChanged=new i.GameEvent}return e.prototype.init=function(e){this._game=e,this._game.onInputStateChanged.subscribe(this.handleInputStateChanged,this)},Object.defineProperty(e.prototype,"boosters",{get:function(){return Array.from(this._boosters.values())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedType",{get:function(){return this._selectedType},set:function(e){this._selectedType=e,this.onSelectedTypeChanged.invoke(this.selectedType)},enumerable:!1,configurable:!0}),e.prototype.canProcess=function(e){return e.getInputState()!=n.InputState.NORMAL},e.prototype.onBoosterSelected=function(){if(this.selectedType!=r.BoosterType.NONE)return this.getBooster(this.selectedType).onBoosterSelected()},e.prototype.onBoosterDeselected=function(){if(this.selectedType!=r.BoosterType.NONE)return this.getBooster(this.selectedType).onBoosterDeselected()},e.prototype.onTileClick=function(e){var t=this._boosters.get(this.selectedType);return t?t.onTileClick(e):null},e.prototype.getBooster=function(e){return this._boosters.get(e)},e.prototype.register=function(e){this._boosters.set(e.type,e)},e.prototype.reset=function(){this.selectedType=r.BoosterType.NONE;for(var e=0,t=Array.from(this._boosters.values());e<t.length;e++)t[e].reset()},e.prototype.apply=function(e){var t=this.getBooster(this.selectedType);null!=t&&t.onBoosterDeselected();var o=this._boosters.get(e);if(!o||e==r.BoosterType.NONE)return this._game.setInputState(n.InputState.NORMAL),null;this._game.setInputState(o.initialInputState)},e.prototype.canApply=function(e){var t;if(e==r.BoosterType.NONE)return!0;var o=this._boosters.get(e);return null!==(t=null==o?void 0:o.canUse())&&void 0!==t&&t},e.prototype.handleInputStateChanged=function(e){switch(e){case n.InputState.NORMAL:this.selectedType=r.BoosterType.NONE;break;case n.InputState.BOMB:this.selectedType=r.BoosterType.BOMB;break;case n.InputState.TELEPORT_PHASE_ONE:case n.InputState.TELEPORT_PHASE_TWO:this.selectedType=r.BoosterType.TELEPORT}},e}();o.Boosters=s,cc._RF.pop()},{"../../GameEvent":"GameEvent","../enums/BoosterType":"BoosterType","../enums/InputState":"InputState"}],Booster:[function(e,t,o){"use strict";cc._RF.push(t,"97bfd3E/NVHX4dqxyPVEewD","Booster"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],Bootstrap:[function(e,t,o){"use strict";cc._RF.push(t,"2bbaf/YlIJDbo8YxrI9AkS6","Bootstrap");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.Bootstrap=void 0;var s=e("./views/BoardView"),c=e("./views/BoosterView"),a=e("./views/LoseView"),u=e("./views/MovesView"),l=e("./views/ScoreView"),p=e("./views/WinView"),f=e("./BlastGame"),h=e("./enums/BoosterType"),d=e("./views/OverlayView"),y=e("./views/TileViewPool"),v=e("./mechanics/Board"),T=e("./mechanics/Boosters"),_=e("./mechanics/Gravity"),m=e("./mechanics/Matches"),S=e("./mechanics/Moves"),b=e("./mechanics/Score"),g=e("./mechanics/Shuffle"),w=e("./mechanics/Spawner"),E=e("./mechanics/superTiles/SuperTiles"),B=e("./mechanics/boosters/BombBooster"),O=e("./mechanics/boosters/TeleportBooster"),R=e("./enums/TileColor"),P=e("./mechanics/superTiles/SuperTileType"),C=e("./mechanics/superTiles/LineSuperTileLogic"),M=e("./mechanics/superTiles/RadiusBombSuperTileLogic"),V=e("./mechanics/superTiles/MaxBombSuperTileLogic"),F=e("./mechanics/Input"),G=e("./views/GameController"),x=e("./NormalClickProcessor"),L=e("./BlastGameMediator"),A=cc._decorator,I=A.ccclass,j=A.property,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boardWidth=8,t.boardHeight=8,t.tileSize=110,t.tileSpacing=2,t.scorePerTile=10,t.targetScore=5e3,t.maxMoves=10,t.maxShuffles=3,t.superTileRemovedCountForLine=5,t.superTileRemovedCountForLineRadiusBomb=8,t.superTileRemovedCountForMaxBomb=10,t.superTileBombRadius=2,t.boosterBombCount=3,t.boosterBombRadius=2,t.boosterTeleportCount=3,t}return r(t,e),t.prototype.onLoad=function(){var e=new T.Boosters;e.register(new B.BombBooster(this.boosterBombCount,this.boosterBombRadius)),e.register(new O.TeleportBooster(this.boosterTeleportCount));var t=new E.SuperTiles;t.register(new C.LineSuperTileLogic(!0),this.superTileRemovedCountForLine),t.register(new C.LineSuperTileLogic(!1),this.superTileRemovedCountForLine),t.register(new M.RadiusBombSuperTileLogic(this.superTileBombRadius),this.superTileRemovedCountForLineRadiusBomb),t.register(new V.MaxBombSuperTileLogic,this.superTileRemovedCountForMaxBomb);var o=new w.Spawner;o.register(R.TileColor.RED),o.register(R.TileColor.BLUE),o.register(R.TileColor.GREEN);var i=new v.Board(this.boardWidth,this.boardHeight),r=new b.Score(this.targetScore,this.scorePerTile),n=new S.Moves(this.maxMoves),s=new g.Shuffle(this.maxShuffles),c=new m.Matches,a=new _.Gravity,u=new F.Input,l=[o],p=[o],d=[s],A=[new x.NormalClickProcessor,e,t],I=[a,o,n,r],j=new f.BlastGame(u,i,r,n,o,s,c,a,t,e,l,p,d,A,I,[]),k=new L.BlastGameMediator(j);this.scoreView.init(k),this.movesView.init(k),this.winView.init(k),this.loseView.init(k),this.bombView.init(k,h.BoosterType.BOMB),this.teleportView.init(k,h.BoosterType.TELEPORT);var N=new y.TileViewPool;N.init(this.tilePrefab,this.boardHeight*this.boardWidth),N.registerRegularTile(R.TileColor.RED,this.redTileSprite),N.registerRegularTile(R.TileColor.BLUE,this.blueTileSprite),N.registerRegularTile(R.TileColor.GREEN,this.greenTileSprite),N.registerRegularTile(R.TileColor.YELLOW,this.yellowTileSprite),N.registerRegularTile(R.TileColor.PURPLE,this.purpleTileSprite),N.registerSuperTile(P.SuperTileType.HORIZONTAL,this.horizontalTileSprite),N.registerSuperTile(P.SuperTileType.VERTICAL,this.verticalTileSprite),N.registerSuperTile(P.SuperTileType.RADIUS_BOMB,this.radiusBombTileSprite),N.registerSuperTile(P.SuperTileType.MAX_BOMB,this.maxBombTileSprite),this.boardView.init(k,N,this.tileSize,this.tileSpacing),new G.GameController(k,this.boardView,new Array(this.bombView,this.teleportView),this.loseView,this.winView,this.movesView,this.scoreView,this.overlayView).init(),j.start()},n([j()],t.prototype,"boardWidth",void 0),n([j()],t.prototype,"boardHeight",void 0),n([j()],t.prototype,"tileSize",void 0),n([j()],t.prototype,"tileSpacing",void 0),n([j()],t.prototype,"scorePerTile",void 0),n([j()],t.prototype,"targetScore",void 0),n([j()],t.prototype,"maxMoves",void 0),n([j()],t.prototype,"maxShuffles",void 0),n([j()],t.prototype,"superTileRemovedCountForLine",void 0),n([j()],t.prototype,"superTileRemovedCountForLineRadiusBomb",void 0),n([j()],t.prototype,"superTileRemovedCountForMaxBomb",void 0),n([j()],t.prototype,"superTileBombRadius",void 0),n([j()],t.prototype,"boosterBombCount",void 0),n([j()],t.prototype,"boosterBombRadius",void 0),n([j()],t.prototype,"boosterTeleportCount",void 0),n([j(c.BoosterView)],t.prototype,"teleportView",void 0),n([j(c.BoosterView)],t.prototype,"bombView",void 0),n([j(s.BoardView)],t.prototype,"boardView",void 0),n([j(l.ScoreView)],t.prototype,"scoreView",void 0),n([j(u.MovesView)],t.prototype,"movesView",void 0),n([j(p.WinView)],t.prototype,"winView",void 0),n([j(a.LoseView)],t.prototype,"loseView",void 0),n([j(d.OverlayView)],t.prototype,"overlayView",void 0),n([j(cc.Prefab)],t.prototype,"tilePrefab",void 0),n([j(cc.SpriteFrame)],t.prototype,"redTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"blueTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"greenTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"yellowTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"purpleTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"horizontalTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"verticalTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"radiusBombTileSprite",void 0),n([j(cc.SpriteFrame)],t.prototype,"maxBombTileSprite",void 0),n([I],t)}(cc.Component);o.Bootstrap=k,cc._RF.pop()},{"./BlastGame":"BlastGame","./BlastGameMediator":"BlastGameMediator","./NormalClickProcessor":"NormalClickProcessor","./enums/BoosterType":"BoosterType","./enums/TileColor":"TileColor","./mechanics/Board":"Board","./mechanics/Boosters":"Boosters","./mechanics/Gravity":"Gravity","./mechanics/Input":"Input","./mechanics/Matches":"Matches","./mechanics/Moves":"Moves","./mechanics/Score":"Score","./mechanics/Shuffle":"Shuffle","./mechanics/Spawner":"Spawner","./mechanics/boosters/BombBooster":"BombBooster","./mechanics/boosters/TeleportBooster":"TeleportBooster","./mechanics/superTiles/LineSuperTileLogic":"LineSuperTileLogic","./mechanics/superTiles/MaxBombSuperTileLogic":"MaxBombSuperTileLogic","./mechanics/superTiles/RadiusBombSuperTileLogic":"RadiusBombSuperTileLogic","./mechanics/superTiles/SuperTileType":"SuperTileType","./mechanics/superTiles/SuperTiles":"SuperTiles","./views/BoardView":"BoardView","./views/BoosterView":"BoosterView","./views/GameController":"GameController","./views/LoseView":"LoseView","./views/MovesView":"MovesView","./views/OverlayView":"OverlayView","./views/ScoreView":"ScoreView","./views/TileViewPool":"TileViewPool","./views/WinView":"WinView"}],DestroyEffect:[function(e,t,o){"use strict";cc._RF.push(t,"acb4abij7ZPJoB2dxxk9TnR","DestroyEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.DestroyEffect=void 0;o.DestroyEffect=function(){},cc._RF.pop()},{}],GameController:[function(e,t,o){"use strict";cc._RF.push(t,"2ee57qyKIpIR5xNSoCeLIRN","GameController");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(r,n){function s(e){try{a(i.next(e))}catch(t){n(t)}}function c(e){try{a(i.throw(e))}catch(t){n(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((i=i.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return a([e,t])}}function a(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameController=void 0;var n=e("../mechanics/effects/DestroyEffect"),s=e("../mechanics/effects/GravityEffect"),c=e("../mechanics/effects/LoseEffect"),a=e("../mechanics/effects/ShakeEffect"),u=e("../mechanics/effects/ShuffleEffect"),l=e("../mechanics/effects/SuperTileSpawnEffect"),p=e("../mechanics/effects/SwapEffect"),f=e("../mechanics/effects/TeleportDeselectEffect"),h=e("../mechanics/effects/TeleportSelectEffect"),d=e("../mechanics/effects/TileSpawnEffect"),y=e("../mechanics/effects/WinEffect"),v=function(){function e(e,t,o,i,r,n,s,c){this._boosterViewsMap=new Map,this._mediator=e,this._boardView=t,this._boosterViews=o,this._loseView=i,this._winView=r,this._movesView=n,this._scoreView=s,this._overlayView=c}return e.prototype.init=function(){this._mediator.onGameStarted.subscribe(this.processEffects,this),this._mediator.onTurnFinished.subscribe(this.processEffects,this),this._mediator.onGameFinished.subscribe(this.processEffects,this),this._mediator.onBoosterSelected.subscribe(this.processEffects,this),this._mediator.onBoosterDeselected.subscribe(this.processEffects,this);for(var e=0,t=this._boosterViews;e<t.length;e++){var o=t[e];this._boosterViewsMap.set(o.type,o)}this._overlayView.hide(!1),this._winView.hide(!1),this._loseView.hide(!1),this._mediator.enableInput(),this._scoreView.updateScore(!1),this._movesView.updateMoves(!1)},e.prototype.processEffects=function(e){return i(this,void 0,void 0,function(){var t,o,i;return r(this,function(r){switch(r.label){case 0:this._mediator.disableInput(),this._overlayView.hide(),this._winView.hide(),this._loseView.hide(),t=0,o=e,r.label=1;case 1:return t<o.length?(i=o[t])instanceof n.DestroyEffect?[4,this._boardView.animateTileRemoval(i.tilesToRemove)]:[3,3]:[3,25];case 2:return r.sent(),[3,24];case 3:return i instanceof l.SuperTileSpawnEffect?[4,this._boardView.animateSuperTileCreation(i.superTile)]:[3,5];case 4:return r.sent(),[3,24];case 5:return i instanceof d.TileSpawnEffect?[4,this._boardView.animateNewTiles(i.tilesToSpawn)]:[3,7];case 6:return r.sent(),[3,24];case 7:return i instanceof s.GravityEffect?[4,this._boardView.animateGravity(i.moves)]:[3,9];case 8:return r.sent(),[3,24];case 9:return i instanceof u.ShuffleEffect?[4,this._boardView.animateShuffle()]:[3,11];case 10:return r.sent(),[3,24];case 11:return i instanceof a.ShakeEffect?(this._boardView.getTileView(i.tileToShake.x,i.tileToShake.y).animateShake(),[3,24]):[3,12];case 12:return i instanceof p.SwapEffect?(this._boardView.getTileView(i.left.x,i.left.y).stopShake(),this._boardView.getTileView(i.right.x,i.right.y).stopShake(),[4,this._boardView.animateTileSwap(i.left,i.right)]):[3,14];case 13:return r.sent(),[3,24];case 14:return i instanceof h.TeleportSelectEffect?(this._boardView.getTileView(i.selectedTile.x,i.selectedTile.y).startShake(),[3,24]):[3,15];case 15:return i instanceof f.TeleportDeselectEffect?(this._boardView.getTileView(i.deselectedTile.x,i.deselectedTile.y).stopShake(),[3,24]):[3,16];case 16:return i instanceof y.WinEffect?[4,this._boardView.animateHideTiles()]:[3,20];case 17:return r.sent(),[4,this._overlayView.show()];case 18:return r.sent(),[4,this._winView.show()];case 19:return r.sent(),this._boardView.reset(),[3,24];case 20:return i instanceof c.LoseEffect?[4,this._boardView.animateHideTiles()]:[3,24];case 21:return r.sent(),[4,this._overlayView.show()];case 22:return r.sent(),[4,this._loseView.show()];case 23:r.sent(),this._boardView.reset(),r.label=24;case 24:return t++,[3,1];case 25:return this._scoreView.updateScore(),this._movesView.updateMoves(),this._mediator.enableInput(),[2]}})})},e}();o.GameController=v,cc._RF.pop()},{"../mechanics/effects/DestroyEffect":"DestroyEffect","../mechanics/effects/GravityEffect":"GravityEffect","../mechanics/effects/LoseEffect":"LoseEffect","../mechanics/effects/ShakeEffect":"ShakeEffect","../mechanics/effects/ShuffleEffect":"ShuffleEffect","../mechanics/effects/SuperTileSpawnEffect":"SuperTileSpawnEffect","../mechanics/effects/SwapEffect":"SwapEffect","../mechanics/effects/TeleportDeselectEffect":"TeleportDeselectEffect","../mechanics/effects/TeleportSelectEffect":"TeleportSelectEffect","../mechanics/effects/TileSpawnEffect":"TileSpawnEffect","../mechanics/effects/WinEffect":"WinEffect"}],GameEvent:[function(e,t,o){"use strict";cc._RF.push(t,"5eeebi2ezlOYIYvFhNtTTEs","GameEvent");var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<o;t++)for(var n=arguments[t],s=0,c=n.length;s<c;s++,r++)i[r]=n[s];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.GameEvent=void 0;var r=function(){function e(){this._handlers=[],this._onceHandlers=[]}return e.prototype.subscribe=function(e,t){var o=this;if(this._onceHandlers.find(function(i){return o.same(i,e,t)}))throw new Error("Error in Event.subscribe(). Already subscribed once");this._handlers.find(function(i){return o.same(i,e,t)})||this._handlers.push({action:e,caller:t})},e.prototype.subscribeOnce=function(e,t){var o=this;if(this._handlers.find(function(i){return o.same(i,e,t)}))throw new Error("Error in Event.subscribeOnce(). Already subscribed");this._onceHandlers.find(function(i){return o.same(i,e,t)})||this._onceHandlers.push({action:e,caller:t})},e.prototype.unsubscribe=function(e,t){var o=this,i=this._handlers.findIndex(function(i){return o.same(i,e,t)});-1!=i&&this._handlers.splice(i,1);var r=this._onceHandlers.findIndex(function(i){return o.same(i,e,t)});-1!=r&&this._onceHandlers.splice(r,1)},e.prototype.unsubscribeAll=function(){this._handlers.length=0,this._onceHandlers.length=0},e.prototype.invoke=function(e){i(this._handlers).forEach(function(t){t.action.call(t.caller,e)}),i(this._onceHandlers).forEach(function(t){return t.action.call(t.caller,e)}),this._onceHandlers.length=0},e.prototype.same=function(e,t,o){return e.action==t&&e.caller==o},e}();o.GameEvent=r,cc._RF.pop()},{}],GameMediator:[function(e,t,o){"use strict";cc._RF.push(t,"90226CNdQ9MXpaHzbx6Cw4F","GameMediator"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GameState:[function(e,t,o){"use strict";cc._RF.push(t,"a823f741klIrKztRhFkbNXc","GameState"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameState=void 0,function(e){e[e.GAME=0]="GAME",e[e.LOSE=1]="LOSE",e[e.WIN=2]="WIN"}(o.GameState||(o.GameState={})),cc._RF.pop()},{}],GravityEffect:[function(e,t,o){"use strict";cc._RF.push(t,"8abb3ycAVlPCLqhOBIGaE+8","GravityEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.GravityEffect=void 0;o.GravityEffect=function(){},cc._RF.pop()},{}],Gravity:[function(e,t,o){"use strict";cc._RF.push(t,"a328bu3rjxCzr08HGXKT/4Y","Gravity"),Object.defineProperty(o,"__esModule",{value:!0}),o.Gravity=void 0;var i=e("../enums/TileColor"),r=e("../Tile"),n=e("./effects/GravityEffect"),s=function(){function e(){}return e.prototype.canProcess=function(){return!0},e.prototype.onPostTurn=function(e){var t=this.applyGravity(e.board),o=new n.GravityEffect;return o.moves=t,o},e.prototype.applyGravity=function(e){for(var t=[],o=0;o<e.width;o++){for(var n=[],s=0;s<e.height;s++)(a=e.getTile(o,s))&&!a.isEmpty&&n.push(a);for(var c=0;c<n.length;c++){var a,u=(a=n[c]).y,l=c;u!==l&&t.push({x:o,fromY:u,toY:l,tile:a}),a.y=l,e.setTile(o,l,a)}for(s=n.length;s<e.height;s++)e.setTile(o,s,new r.Tile(o,s,i.TileColor.EMPTY))}return t},e}();o.Gravity=s,cc._RF.pop()},{"../Tile":"Tile","../enums/TileColor":"TileColor","./effects/GravityEffect":"GravityEffect"}],InputState:[function(e,t,o){"use strict";cc._RF.push(t,"e5b4e11pmhGxKtn3J7JT3Y9","InputState"),Object.defineProperty(o,"__esModule",{value:!0}),o.InputState=void 0,function(e){e[e.NORMAL=0]="NORMAL",e[e.TELEPORT_PHASE_ONE=1]="TELEPORT_PHASE_ONE",e[e.TELEPORT_PHASE_TWO=2]="TELEPORT_PHASE_TWO",e[e.BOMB=3]="BOMB"}(o.InputState||(o.InputState={})),cc._RF.pop()},{}],Input:[function(e,t,o){"use strict";cc._RF.push(t,"9d747AD7R5K95M+uJfQySAF","Input"),Object.defineProperty(o,"__esModule",{value:!0}),o.Input=void 0;var i=e("../../GameEvent"),r=e("../enums/GameState"),n=function(){function e(){this._enabled=!0,this.onTileClicked=new i.GameEvent}return e.prototype.canProcess=function(e){return e.getState()==r.GameState.GAME},e.prototype.invokeTileClick=function(e){this.onTileClicked.invoke(e)},Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this._enabled},enumerable:!1,configurable:!0}),e.prototype.enable=function(){this._enabled=!0},e.prototype.disable=function(){this._enabled=!1},e}();o.Input=n,cc._RF.pop()},{"../../GameEvent":"GameEvent","../enums/GameState":"GameState"}],LineSuperTileLogic:[function(e,t,o){"use strict";cc._RF.push(t,"9b2107uu8pM267mw3zkrML9","LineSuperTileLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.LineSuperTileLogic=void 0;var i=e("./SuperTileType"),r=e("./SuperTile"),n=e("../effects/DestroyEffect"),s=function(){function e(e){this.type=e?i.SuperTileType.HORIZONTAL:i.SuperTileType.VERTICAL}return e.prototype.canProcess=function(e){return this.canProcessTile(e.selectedTile)},e.prototype.canProcessTile=function(e){return e instanceof r.SuperTile&&e.type==this.type},e.prototype.onTileClick=function(e){for(var t=this.activate(e.selectedTile,e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.tilesToRemove.add(r)}var s=new n.DestroyEffect;return s.tilesToRemove=t,s},e.prototype.activate=function(e,t){for(var o=[],r=this.type==i.SuperTileType.HORIZONTAL?t.width:t.height,n=0;n<r;n++){var s=this.type==i.SuperTileType.HORIZONTAL?n:e.x,c=this.type==i.SuperTileType.HORIZONTAL?e.y:n,a=t.getTile(s,c);a&&!a.isEmpty&&o.push(a)}return o},e}();o.LineSuperTileLogic=s,cc._RF.pop()},{"../effects/DestroyEffect":"DestroyEffect","./SuperTile":"SuperTile","./SuperTileType":"SuperTileType"}],LoseEffect:[function(e,t,o){"use strict";cc._RF.push(t,"146753HyI9FyLUC+s8lBdmN","LoseEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.LoseEffect=void 0;o.LoseEffect=function(){},cc._RF.pop()},{}],LoseView:[function(e,t,o){"use strict";cc._RF.push(t,"7c6e08TU+1BKLD32CrvgXIl","LoseView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(r,n){function s(e){try{a(i.next(e))}catch(t){n(t)}}function c(e){try{a(i.throw(e))}catch(t){n(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((i=i.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return a([e,t])}}function a(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.LoseView=void 0;var a=cc._decorator,u=a.ccclass,l=a.property,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(e){var t=this;this._mediator=e,this.button.node.on("click",function(){t._mediator.finishGame(),t._mediator.startGame()})},t.prototype.show=function(e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){return c(this,function(){return this.panelLose.scale=0,this.panelLose.active=!0,this.panelLose.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3))),[2]})})},t.prototype.hide=function(e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var t=this;return c(this,function(){return e?(this.panelLose.stopAllActions(),this.panelLose.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,0),cc.fadeOut(.3)),cc.callFunc(function(){t.panelLose.active=!1,t.panelLose.opacity=255})))):(this.panelLose.active=!1,this.panelLose.opacity=255),[2]})})},n([l(cc.Button)],t.prototype,"button",void 0),n([l(cc.Node)],t.prototype,"panelLose",void 0),n([u],t)}(cc.Component);o.LoseView=p,cc._RF.pop()},{}],Matches:[function(e,t,o){"use strict";cc._RF.push(t,"8f3e1aZfqVMt5c5ETGIQtOG","Matches"),Object.defineProperty(o,"__esModule",{value:!0}),o.Matches=void 0;var i=e("./superTiles/SuperTile"),r=function(){function e(){}return e.prototype.hasAvailableMatches=function(e){if(this.hasSuperTile(e))return!0;for(var t=new Set,o=0;o<e.width;o++)for(var i=0;i<e.height;i++){var r=i*e.width+o;if(!t.has(r)){var n=e.getTile(o,i);if(n&&!n.isEmpty){var s=this.getAvaliableMatch(e,o,i);if(s.length>=2)return!0;s.forEach(function(o){var i=o.y*e.width+o.x;t.add(i)})}}}return!1},e.prototype.getAvaliableMatch=function(e,t,o){var i=e.getTile(t,o);if(!i||i.isEmpty)return[];for(var r=Array.from({length:e.width},function(){return new Array(e.height).fill(!1)}),n=[],s=[[t,o]],c=i.color,a=[[1,0],[-1,0],[0,1],[0,-1]];s.length>0;){var u=s.shift(),l=u[0],p=u[1];if(!(l<0||l>=e.width||p<0||p>=e.height||r[l][p])){var f=e.getTile(l,p);if(f&&!f.isEmpty&&f.color===c){r[l][p]=!0,n.push(f);for(var h=0,d=a;h<d.length;h++){var y=d[h],v=y[0],T=y[1];s.push([l+v,p+T])}}}}return n.length>=2?n:[]},e.prototype.hasSuperTile=function(e){for(var t=0;t<e.width;t++)for(var o=0;o<e.height;o++)if(e.getTile(t,o)instanceof i.SuperTile)return!0;return!1},e}();o.Matches=r,cc._RF.pop()},{"./superTiles/SuperTile":"SuperTile"}],MaxBombSuperTileLogic:[function(e,t,o){"use strict";cc._RF.push(t,"2ff1cmOzBRDq5km4wZWzUfu","MaxBombSuperTileLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.MaxBombSuperTileLogic=void 0;var i=e("./SuperTileType"),r=e("./SuperTile"),n=e("../effects/DestroyEffect"),s=function(){function e(){this.type=i.SuperTileType.MAX_BOMB}return e.prototype.canProcess=function(e){return e.selectedTile instanceof r.SuperTile&&e.selectedTile.type==this.type},e.prototype.onTileClick=function(e){for(var t=this.activate(e.selectedTile,e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.tilesToRemove.add(r)}var s=new n.DestroyEffect;return s.tilesToRemove=t,s},e.prototype.activate=function(e,t){for(var o=[],i=0;i<t.width;i++)for(var r=0;r<t.height;r++){var n=t.getTile(i,r);n&&!n.isEmpty&&o.push(n)}return o},e}();o.MaxBombSuperTileLogic=s,cc._RF.pop()},{"../effects/DestroyEffect":"DestroyEffect","./SuperTile":"SuperTile","./SuperTileType":"SuperTileType"}],MovesView:[function(e,t,o){"use strict";cc._RF.push(t,"f32f4hpym5JlJNwd3sgCBcZ","MovesView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.MovesView=void 0;var s=cc._decorator,c=s.ccclass,a=s.property,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(e){this._mediator=e,this._currentDisplayMoves=this._mediator.getMovesCount()},t.prototype.updateMoves=function(e){var t=this;return void 0===e&&(e=!0),e?new Promise(function(e){if(t.label){if(t._currentDisplayMoves==t._mediator.getMovesCount())return t._currentDisplayMoves=t._mediator.getMovesCount(),t.label.string=""+t._mediator.getMovesCount(),void e();var o,i=t._currentDisplayMoves,r=t._mediator.getMovesCount(),n=r-i;0!==n?(t.label.node.stopActionByTag(101),t._currentDisplayMoves=r,t.label.string=""+t._currentDisplayMoves,(o=n<0?cc.sequence(cc.spawn(cc.scaleTo(.15,1.2).easing(cc.easeOut(2)),cc.tintTo(.15,255,100,100)),cc.spawn(cc.scaleTo(.25,1).easing(cc.easeBackOut()),cc.tintTo(.25,255,255,255)),cc.callFunc(function(){e()})):cc.sequence(cc.spawn(cc.scaleTo(.15,1.2).easing(cc.easeOut(2)),cc.tintTo(.15,100,255,100)),cc.spawn(cc.scaleTo(.25,1).easing(cc.easeBackOut()),cc.tintTo(.25,255,255,255)),cc.callFunc(function(){e()}))).setTag(101),t.label.node.runAction(o)):e()}else e()}):new Promise(function(e){t.label.string=t.label.string=""+t._mediator.getMovesCount(),e()})},n([a(cc.Label)],t.prototype,"label",void 0),n([c],t)}(cc.Component);o.MovesView=u,cc._RF.pop()},{}],Moves:[function(e,t,o){"use strict";cc._RF.push(t,"8680dr3NF9AA4YWIC7vAzmR","Moves"),Object.defineProperty(o,"__esModule",{value:!0}),o.Moves=void 0;var i=e("../../GameEvent"),r=e("../enums/GameState"),n=e("./effects/LoseEffect"),s=function(){function e(e){this.onMovesChanged=new i.GameEvent,this._currentMoves=e,this.maxMoves=e}return Object.defineProperty(e.prototype,"currentMoves",{get:function(){return this._currentMoves},set:function(e){var t;this._currentMoves=e,null===(t=this.onMovesChanged)||void 0===t||t.invoke(this.currentMoves)},enumerable:!1,configurable:!0}),e.prototype.canProcess=function(){return!0},e.prototype.onPostTurn=function(e){return e.initialRemovedCount>0&&this.decrementMove(),this.hasMovesLeft()?null:(e.setState(r.GameState.WIN),new n.LoseEffect)},e.prototype.decrementMove=function(){this._currentMoves>0&&this.currentMoves--},e.prototype.hasMovesLeft=function(){return this._currentMoves>0},e.prototype.reset=function(){this.currentMoves=this.maxMoves},e}();o.Moves=s,cc._RF.pop()},{"../../GameEvent":"GameEvent","../enums/GameState":"GameState","./effects/LoseEffect":"LoseEffect"}],NormalClickProcessor:[function(e,t,o){"use strict";cc._RF.push(t,"0833f+5iKJOmpmT1U/ySgG+","NormalClickProcessor");var i=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<o;t++)for(var n=arguments[t],s=0,c=n.length;s<c;s++,r++)i[r]=n[s];return i};Object.defineProperty(o,"__esModule",{value:!0}),o.NormalClickProcessor=void 0;var r=e("./enums/InputState"),n=e("./mechanics/effects/DestroyEffect"),s=e("./mechanics/effects/ShakeEffect"),c=e("./mechanics/superTiles/SuperTile"),a=function(){function e(){}return e.prototype.canProcess=function(e){return e.getInputState()==r.InputState.NORMAL},e.prototype.onTileClick=function(e){var t=e.matches.getAvaliableMatch(e.board,e.selectedTile.x,e.selectedTile.y);if(e.initialRemovedCount=t.length,0==t.length){var o=new s.ShakeEffect;return o.tileToShake=e.selectedTile,o}for(var r=e.selectedTile instanceof c.SuperTile?i(t,[e.selectedTile]):i(t),a=0,u=r;a<u.length;a++){var l=u[a];e.tilesToRemove.add(l)}var p=new n.DestroyEffect;return p.tilesToRemove=r,p},e}();o.NormalClickProcessor=a,cc._RF.pop()},{"./enums/InputState":"InputState","./mechanics/effects/DestroyEffect":"DestroyEffect","./mechanics/effects/ShakeEffect":"ShakeEffect","./mechanics/superTiles/SuperTile":"SuperTile"}],OverlayView:[function(e,t,o){"use strict";cc._RF.push(t,"a6e77yI4KVMC7pUe7qUplnC","OverlayView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(r,n){function s(e){try{a(i.next(e))}catch(t){n(t)}}function c(e){try{a(i.throw(e))}catch(t){n(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((i=i.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return a([e,t])}}function a(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverlayView=void 0;var a=cc._decorator,u=a.ccclass,l=a.property,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onEnable=function(){this._currentOpacity=this.ovelay.opacity},t.prototype.show=function(e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){return c(this,function(){return e?(this.ovelay.opacity=0,this.ovelay.active=!0,this.ovelay.runAction(cc.fadeTo(.3,this._currentOpacity))):this.ovelay.opacity=this._currentOpacity,[2]})})},t.prototype.hide=function(e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var t=this;return c(this,function(){return e?this.ovelay.runAction(cc.sequence(cc.fadeOut(.3),cc.callFunc(function(){t.ovelay.active=!1}))):this.ovelay.active=!1,[2]})})},n([l(cc.Node)],t.prototype,"ovelay",void 0),n([u],t)}(cc.Component);o.OverlayView=p,cc._RF.pop()},{}],RadiusBombSuperTileLogic:[function(e,t,o){"use strict";cc._RF.push(t,"13630YOrLZDi4/Rf9B0mdVh","RadiusBombSuperTileLogic"),Object.defineProperty(o,"__esModule",{value:!0}),o.RadiusBombSuperTileLogic=void 0;var i=e("./SuperTileType"),r=e("./SuperTile"),n=e("../effects/DestroyEffect"),s=function(){function e(e){this.type=i.SuperTileType.RADIUS_BOMB,this._bombRadius=e}return e.prototype.canProcess=function(e){return e.selectedTile instanceof r.SuperTile&&e.selectedTile.type==this.type},e.prototype.canProcessTile=function(e){return e instanceof r.SuperTile&&e.type==this.type},e.prototype.onTileClick=function(e){for(var t=this.activate(e.selectedTile,e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.tilesToRemove.add(r)}var s=new n.DestroyEffect;return s.tilesToRemove=t,s},e.prototype.activate=function(e,t){for(var o=[],i=-this._bombRadius;i<=this._bombRadius;i++)for(var r=-this._bombRadius;r<=this._bombRadius;r++)if(Math.sqrt(i*i+r*r)<=this._bombRadius){var n=t.getTile(e.x+i,e.y+r);n&&!n.isEmpty&&o.push(n)}return o},e}();o.RadiusBombSuperTileLogic=s,cc._RF.pop()},{"../effects/DestroyEffect":"DestroyEffect","./SuperTile":"SuperTile","./SuperTileType":"SuperTileType"}],ScoreView:[function(e,t,o){"use strict";cc._RF.push(t,"d2cc0s8AfxHxb0ObNchtox2","ScoreView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreView=void 0;var s=cc._decorator,c=s.ccclass,a=s.property,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(e){this._mediator=e,this._currentDisplayScore=this._mediator.getCurrentScore()},t.prototype.updateScore=function(e){var t=this;return void 0===e&&(e=!0),e?new Promise(function(e){if(t.label){if(t._currentDisplayScore==t._mediator.getCurrentScore())return t._currentDisplayScore=t._mediator.getCurrentScore(),t.label.string=t._mediator.getCurrentScore()+"/"+t._mediator.getTargetScore(),void e();var o=t._currentDisplayScore,i=t._mediator.getCurrentScore(),r=i-o;if(0!==r){t.label.node.stopActionByTag(100);var n=r/20,s=0,c=cc.repeat(cc.sequence(cc.delayTime(.025),cc.callFunc(function(){s++,t._currentDisplayScore=Math.floor(o+n*s),s>=20&&(t._currentDisplayScore=i),t.label.string=t._currentDisplayScore+"/"+t._mediator.getTargetScore()})),20),a=cc.sequence(cc.spawn(cc.scaleTo(.2,1.3).easing(cc.easeOut(2)),cc.tintTo(.2,255,255,100)),cc.spawn(cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.tintTo(.3,255,255,255))),u=cc.spawn(c,cc.sequence(a,cc.callFunc(function(){e()})));u.setTag(100),t.label.node.runAction(u)}else e()}else e()}):new Promise(function(e){t.label.string=t._mediator.getCurrentScore()+"/"+t._mediator.getTargetScore(),e()})},n([a(cc.Label)],t.prototype,"label",void 0),n([c],t)}(cc.Component);o.ScoreView=u,cc._RF.pop()},{}],Score:[function(e,t,o){"use strict";cc._RF.push(t,"7cde4BqeNhDO6LoXXiW2B8R","Score"),Object.defineProperty(o,"__esModule",{value:!0}),o.Score=void 0;var i=e("../../GameEvent"),r=e("../enums/GameState"),n=e("./effects/WinEffect"),s=function(){function e(e,t){this.onScoreChanged=new i.GameEvent,this._currentScore=0,this.targetScore=e,this.scorePerTile=t}return e.prototype.canProcess=function(){return!0},e.prototype.onPostTurn=function(e){return this.addScore(this.calculateScore(e.tilesToRemove.size)),this.hasReachedTarget()?(e.setState(r.GameState.WIN),new n.WinEffect):null},Object.defineProperty(e.prototype,"currentScore",{get:function(){return this._currentScore},set:function(e){var t;this._currentScore=e,null===(t=this.onScoreChanged)||void 0===t||t.invoke(this.currentScore)},enumerable:!1,configurable:!0}),e.prototype.calculateScore=function(e){return e*e*this.scorePerTile},e.prototype.addScore=function(e){this.currentScore+=e},e.prototype.hasReachedTarget=function(){return this._currentScore>=this.targetScore},e.prototype.reset=function(){this.currentScore=0},e}();o.Score=s,cc._RF.pop()},{"../../GameEvent":"GameEvent","../enums/GameState":"GameState","./effects/WinEffect":"WinEffect"}],ShakeEffect:[function(e,t,o){"use strict";cc._RF.push(t,"0184bTXnVdPD5dXjNCkbCvS","ShakeEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShakeEffect=void 0;o.ShakeEffect=function(){},cc._RF.pop()},{}],ShuffleEffect:[function(e,t,o){"use strict";cc._RF.push(t,"f134eV/Zp9POKDjNp7G1j4G","ShuffleEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShuffleEffect=void 0;o.ShuffleEffect=function(){},cc._RF.pop()},{}],Shuffle:[function(e,t,o){"use strict";cc._RF.push(t,"5fc14noN1JKmrfrO3do9Xkt","Shuffle"),Object.defineProperty(o,"__esModule",{value:!0}),o.Shuffle=void 0;var i=e("./effects/ShuffleEffect"),r=function(){function e(e){this.maxAttempts=e,this._attempts=e}return Object.defineProperty(e.prototype,"attempts",{get:function(){return this._attempts},enumerable:!1,configurable:!0}),e.prototype.canProcess=function(){return!0},e.prototype.onPreTurn=function(e){this.reset();for(var t=!1;this.shuffleAvaliable()&&!e.matches.hasAvailableMatches(e.board);)this.shuffle(e.board),t=!0;if(t&&e.matches.hasAvailableMatches(e.board)){var o=new i.ShuffleEffect;return o.tilesToShuffle=e.board.getAllTiles(),o}},e.prototype.shuffleAvaliable=function(){return this._attempts>0},e.prototype.shuffle=function(e){for(var t,o=[],i=0;i<e.width;i++)for(var r=0;r<e.height;r++)(a=e.getTile(i,r))&&!a.isEmpty&&o.push(a);for(var n=o.length-1;n>0;n--){var s=Math.floor(Math.random()*(n+1));t=[o[s],o[n]],o[n]=t[0],o[s]=t[1]}var c=0;for(i=0;i<e.width;i++)for(r=0;r<e.height;r++){var a;c<o.length&&((a=o[c]).setPosition(i,r),e.setTile(i,r,a),c++)}},e.prototype.reset=function(){this._attempts=this.maxAttempts},e}();o.Shuffle=r,cc._RF.pop()},{"./effects/ShuffleEffect":"ShuffleEffect"}],Spawner:[function(e,t,o){"use strict";cc._RF.push(t,"5a723gFA0VCILwuJJzptWh8","Spawner"),Object.defineProperty(o,"__esModule",{value:!0}),o.Spawner=void 0;var i=e("../enums/TileColor"),r=e("../Tile"),n=e("./superTiles/SuperTile"),s=e("./effects/TileSpawnEffect"),c=function(){function e(){this.avaliableColors=Array()}return e.prototype.canProcess=function(){return!0},e.prototype.onPreGame=function(e){for(var t=this.fillWithRegularTiles(e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.board.setTile(r.x,r.y,r)}var n=new s.TileSpawnEffect;return n.tilesToSpawn=t,n},e.prototype.onPostGame=function(e){return e.board.clear(),null},e.prototype.onPostTurn=function(e){for(var t=this.fillWithRegularTiles(e.board),o=0,i=t;o<i.length;o++){var r=i[o];e.board.setTile(r.x,r.y,r)}var n=new s.TileSpawnEffect;return n.tilesToSpawn=t,n},e.prototype.register=function(e){this.avaliableColors.push(e)},e.prototype.fillWithRegularTiles=function(e){for(var t=new Array,o=0;o<e.width;o++)for(var i=0;i<e.height;i++)if(null==e.getTile(o,i)||e.getTile(o,i).isEmpty){var r=this.createRandomRegularTile(o,i);e.setTile(o,i,r),t.push(r)}return t},e.prototype.createRandomRegularTile=function(e,t){var o=Math.floor(Math.random()*this.avaliableColors.length);return new r.Tile(e,t,o)},e.prototype.createSuperTile=function(e,t,o){return new n.SuperTile(e,t,i.TileColor.SPECIAL,o)},e.prototype.createRegularTile=function(e,t,o){return new r.Tile(e,t,o)},e}();o.Spawner=c,cc._RF.pop()},{"../Tile":"Tile","../enums/TileColor":"TileColor","./effects/TileSpawnEffect":"TileSpawnEffect","./superTiles/SuperTile":"SuperTile"}],SuperTileFactory:[function(e,t,o){"use strict";cc._RF.push(t,"a31beqOcY5C0IZXEOYF7lyt","SuperTileFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTileFactory=void 0;var i=e("./SuperTileType"),r=function(){function e(){this._thresholds=[]}return e.prototype.register=function(e,t){this._thresholds.push({threshold:t,type:e})},e.prototype.getType=function(e){var t=this._thresholds.filter(function(t){return e>=t.threshold});return 0==t.length?i.SuperTileType.NONE:t[Math.floor(Math.random()*t.length)].type},e}();o.SuperTileFactory=r,cc._RF.pop()},{"./SuperTileType":"SuperTileType"}],SuperTileLogic:[function(e,t,o){"use strict";cc._RF.push(t,"afb138VjedIzaFux1e1jszn","SuperTileLogic"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],SuperTileSpawnEffect:[function(e,t,o){"use strict";cc._RF.push(t,"66995FdfW1AG7NOQAQOvxs/","SuperTileSpawnEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTileSpawnEffect=void 0;o.SuperTileSpawnEffect=function(){},cc._RF.pop()},{}],SuperTileType:[function(e,t,o){"use strict";cc._RF.push(t,"1c888xJwrlAUL8ylGnSftXA","SuperTileType"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTileType=void 0,function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL",e[e.RADIUS_BOMB=2]="RADIUS_BOMB",e[e.MAX_BOMB=3]="MAX_BOMB",e[e.NONE=-1]="NONE"}(o.SuperTileType||(o.SuperTileType={})),cc._RF.pop()},{}],SuperTiles:[function(e,t,o){"use strict";cc._RF.push(t,"b4a1cOPyG9FcpLN5K/4fTM4","SuperTiles"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTiles=void 0;var i=e("./SuperTileType"),r=e("./SuperTile"),n=e("./SuperTileFactory"),s=e("../effects/SuperTileSpawnEffect"),c=e("../effects/DestroyEffect"),a=function(){function e(){this._logics=new Map,this._typeFactory=new n.SuperTileFactory}return e.prototype.register=function(e,t){this._logics.set(e.type,e),this._typeFactory.register(e.type,t)},e.prototype.canProcess=function(){return!0},e.prototype.onTileClick=function(e){if(e.selectedTile instanceof r.SuperTile){var t=this.applyChainReaction(e.selectedTile,e.board);return t.forEach(function(t){return e.tilesToRemove.add(t)}),(n=new c.DestroyEffect).tilesToRemove=t,n}var o=this.getSuperTileType(e.initialRemovedCount);if(o==i.SuperTileType.NONE)return null;e.tilesToRemove.delete(e.board.getTile(e.selectedTile.x,e.selectedTile.y));var n,a=e.spawner.createSuperTile(e.selectedTile.x,e.selectedTile.y,o);return e.board.setTile(e.selectedTile.x,e.selectedTile.y,a),(n=new s.SuperTileSpawnEffect).superTile=a,n},e.prototype.getSuperTileType=function(e){return this._typeFactory.getType(e)},e.prototype.activate=function(e,t){var o=this._logics.get(e.type);return o?o.activate(e,t):[]},e.prototype.applyChainReaction=function(e,t){for(var o=new Set,i=new Set,n=[e];n.length>0;){var s=n.shift();if(!i.has(s)&&(i.add(s),s instanceof r.SuperTile)){var c=this.activate(s,t);o.add(s);for(var a=0,u=c;a<u.length;a++){var l=u[a];o.add(l),l instanceof r.SuperTile&&!i.has(l)&&n.push(l)}}}return Array.from(o)},e}();o.SuperTiles=a,cc._RF.pop()},{"../effects/DestroyEffect":"DestroyEffect","../effects/SuperTileSpawnEffect":"SuperTileSpawnEffect","./SuperTile":"SuperTile","./SuperTileFactory":"SuperTileFactory","./SuperTileType":"SuperTileType"}],SuperTile:[function(e,t,o){"use strict";cc._RF.push(t,"2082aFxIdxItpGW+YJGydML","SuperTile");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTile=void 0;var n=function(e){function t(t,o,i,r){var n=e.call(this,t,o,i)||this;return n.type=r,n}return r(t,e),t}(e("../../Tile").Tile);o.SuperTile=n,cc._RF.pop()},{"../../Tile":"Tile"}],SwapEffect:[function(e,t,o){"use strict";cc._RF.push(t,"6a44a3cKgVCa6MVSnhm2Kl6","SwapEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.SwapEffect=void 0;o.SwapEffect=function(){},cc._RF.pop()},{}],TeleportBooster:[function(e,t,o){"use strict";cc._RF.push(t,"cd235ZO1FBJQ5aRKxOhiNSz","TeleportBooster"),Object.defineProperty(o,"__esModule",{value:!0}),o.TeleportBooster=void 0;var i=e("../../../GameEvent"),r=e("../../enums/BoosterType"),n=e("../../enums/InputState"),s=e("../effects/SwapEffect"),c=e("../effects/TeleportDeselectEffect"),a=e("../effects/TeleportSelectEffect"),u=function(){function e(e){this.type=r.BoosterType.TELEPORT,this.initialInputState=n.InputState.TELEPORT_PHASE_ONE,this.onCountChanged=new i.GameEvent,this._maxCount=e,this._count=e}return e.prototype.canProcess=function(){return this.canUse()},e.prototype.onBoosterSelected=function(){return null},e.prototype.onBoosterDeselected=function(){if(null!=this._firstTile){var e=new c.TeleportDeselectEffect;return e.deselectedTile=this._firstTile,this._firstTile=null,e}return null},e.prototype.onTileClick=function(e){if(!this.canUse())return[];if(!this._firstTile){this._firstTile=e.selectedTile,e.setInputState(n.InputState.TELEPORT_PHASE_TWO);var t=new a.TeleportSelectEffect;return t.selectedTile=this._firstTile,t}if(this._firstTile==e.selectedTile){var o=new c.TeleportDeselectEffect;return o.deselectedTile=this._firstTile,this._firstTile=null,o}e.board.swapTiles(this._firstTile,e.selectedTile);var i=new s.SwapEffect;return i.left=this._firstTile,i.right=e.selectedTile,this._firstTile=null,this.setCount(this._count-1),e.setInputState(n.InputState.NORMAL),i},e.prototype.getCount=function(){return this._count},e.prototype.canUse=function(){return this._count>0},e.prototype.reset=function(){this.setCount(this._maxCount),this._firstTile=null},e.prototype.setCount=function(e){this._count=e,this.onCountChanged.invoke(this._count)},e}();o.TeleportBooster=u,cc._RF.pop()},{"../../../GameEvent":"GameEvent","../../enums/BoosterType":"BoosterType","../../enums/InputState":"InputState","../effects/SwapEffect":"SwapEffect","../effects/TeleportDeselectEffect":"TeleportDeselectEffect","../effects/TeleportSelectEffect":"TeleportSelectEffect"}],TeleportDeselectEffect:[function(e,t,o){"use strict";cc._RF.push(t,"37bf1PbRBNGS72taKg6r75b","TeleportDeselectEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.TeleportDeselectEffect=void 0;o.TeleportDeselectEffect=function(){},cc._RF.pop()},{}],TeleportSelectEffect:[function(e,t,o){"use strict";cc._RF.push(t,"b8a263x/2ZO7JTHKXUKTa5O","TeleportSelectEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.TeleportSelectEffect=void 0;o.TeleportSelectEffect=function(){},cc._RF.pop()},{}],TileColor:[function(e,t,o){"use strict";cc._RF.push(t,"ee044krjV5NH56pcD/FIZ/6","TileColor"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileColor=void 0,function(e){e[e.RED=0]="RED",e[e.BLUE=1]="BLUE",e[e.GREEN=2]="GREEN",e[e.YELLOW=3]="YELLOW",e[e.PURPLE=4]="PURPLE",e[e.SPECIAL=5]="SPECIAL",e[e.EMPTY=-1]="EMPTY"}(o.TileColor||(o.TileColor={})),cc._RF.pop()},{}],TileSpawnEffect:[function(e,t,o){"use strict";cc._RF.push(t,"bf93cuFvNJLLZJSm9sBxxzW","TileSpawnEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileSpawnEffect=void 0;o.TileSpawnEffect=function(){},cc._RF.pop()},{}],TileViewPool:[function(e,t,o){"use strict";cc._RF.push(t,"e642ccsMD1Jm4kM88JHsefy","TileViewPool"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileViewPool=void 0;var i=e("../mechanics/superTiles/SuperTile"),r=e("./TileView"),n=function(){function e(){this.regularTilesSprites=new Map,this.superTilesSprites=new Map}return e.prototype.registerRegularTile=function(e,t){this.regularTilesSprites.set(e,t)},e.prototype.registerSuperTile=function(e,t){this.superTilesSprites.set(e,t)},e.prototype.init=function(t,o){this.prefab=t,this.pool=new cc.NodePool(e.TILES_POOL_NAME);for(var i=0;i<o;i++){var r=cc.instantiate(this.prefab);this.pool.put(r)}},e.prototype.terminate=function(){this.pool.clear()},e.prototype.get=function(e){var t=this.pool.get();null==t&&(t=cc.instantiate(this.prefab));var o=t.getComponent(r.default);if(e instanceof i.SuperTile){var n=this.superTilesSprites.get(e.type);o.setSpriteFrame(n)}else n=this.regularTilesSprites.get(e.color),o.setSpriteFrame(n);return o},e.prototype.put=function(e){this.pool.put(e.node)},e.TILES_POOL_NAME="TilesPool",e}();o.TileViewPool=n,cc._RF.pop()},{"../mechanics/superTiles/SuperTile":"SuperTile","./TileView":"TileView"}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"ad713u6Fd5B26+VYCB9cWSt","TileView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=s.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t.shakeAction=null,t}return r(t,e),t.prototype.setSpriteFrame=function(e){e?(this.node.active=!0,this.sprite.spriteFrame=e):this.node.active=!1},t.prototype.getPosition=function(){return this.node.position},t.prototype.startShake=function(){this.stopShake();var e=cc.sequence(cc.moveBy(.05,-10,0),cc.moveBy(.05,20,0),cc.moveBy(.05,-20,0),cc.moveBy(.05,10,0));this._originalPos=this.node.position.clone();var t=cc.repeatForever(e);t.setTag(999),this.shakeAction=this.node.runAction(t)},t.prototype.stopShake=function(){this.node.stopActionByTag(999),this.shakeAction&&(this.node.stopAction(this.shakeAction),this.shakeAction=null),null!=this._originalPos&&this.node.setPosition(Math.round(this._originalPos.x),Math.round(this._originalPos.y))},t.prototype.animateShake=function(){this.node.stopActionByTag(999);var e=this.node.position.clone(),t=cc.sequence(cc.moveBy(.05,-10,0),cc.moveBy(.05,20,0),cc.moveBy(.05,-20,0),cc.moveBy(.05,10,0),cc.moveTo(0,e.x,e.y));t.setTag(999),this.node.runAction(t)},n([a(cc.Sprite)],t.prototype,"sprite",void 0),n([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{}],Tile:[function(e,t,o){"use strict";cc._RF.push(t,"47fd5mz3tVEXZ11SnAmsDI3","Tile"),Object.defineProperty(o,"__esModule",{value:!0}),o.Tile=void 0;var i=e("./enums/TileColor"),r=function(){function e(e,t,o){this.x=e,this.y=t,this.color=o}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.color==i.TileColor.EMPTY},enumerable:!1,configurable:!0}),e.prototype.setPosition=function(e,t){this.x=e,this.y=t},e}();o.Tile=r,cc._RF.pop()},{"./enums/TileColor":"TileColor"}],TurnContext:[function(e,t,o){"use strict";cc._RF.push(t,"3bcd3/+U1dCDZu99UFzz5Gx","TurnContext"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TurnEffect:[function(e,t,o){"use strict";cc._RF.push(t,"9e0ebh8bMlMTZgqyiWIhQze","TurnEffect"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],TurnProcessor:[function(e,t,o){"use strict";cc._RF.push(t,"53df3nEnk5Iz4bdDirSa2Zz","TurnProcessor"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],WinEffect:[function(e,t,o){"use strict";cc._RF.push(t,"11106EQAXtEIZh3h/hvbaJ3","WinEffect"),Object.defineProperty(o,"__esModule",{value:!0}),o.WinEffect=void 0;o.WinEffect=function(){},cc._RF.pop()},{}],WinView:[function(e,t,o){"use strict";cc._RF.push(t,"1fd5a8HdBdO+ZnUN9fL9qBw","WinView");var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=this&&this.__decorate||function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(r,n){function s(e){try{a(i.next(e))}catch(t){n(t)}}function c(e){try{a(i.throw(e))}catch(t){n(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((i=i.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,i,r,n,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function c(e){return function(t){return a([e,t])}}function a(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&n[0]?i.return:n[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,n[1])).done)return r;switch(i=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(c){n=[6,c],i=0}finally{o=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.WinView=void 0;var a=cc._decorator,u=a.ccclass,l=a.property,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(e){var t=this;this._mediator=e,this.button.node.on("click",function(){t._mediator.finishGame(),t._mediator.startGame()})},t.prototype.show=function(){return s(this,void 0,void 0,function(){return c(this,function(){return this.panelWin.scale=0,this.panelWin.active=!0,this.panelWin.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3))),[2]})})},t.prototype.hide=function(e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var t=this;return c(this,function(){return e?(this.panelWin.stopAllActions(),this.panelWin.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,0),cc.fadeOut(.3)),cc.callFunc(function(){t.panelWin.active=!1,t.panelWin.opacity=255})))):(this.panelWin.active=!1,this.panelWin.opacity=255),[2]})})},n([l(cc.Button)],t.prototype,"button",void 0),n([l(cc.Node)],t.prototype,"panelWin",void 0),n([u],t)}(cc.Component);o.WinView=p,cc._RF.pop()},{}]},{},["GameEvent","BlastGame","BlastGameMediator","Bootstrap","NormalClickProcessor","Tile","TurnContext","TurnProcessor","BoosterType","GameState","InputState","TileColor","Board","Boosters","GameMediator","Gravity","Input","Matches","Moves","Score","Shuffle","Spawner","TurnEffect","BombBooster","Booster","TeleportBooster","DestroyEffect","GravityEffect","LoseEffect","ShakeEffect","ShuffleEffect","SuperTileSpawnEffect","SwapEffect","TeleportDeselectEffect","TeleportSelectEffect","TileSpawnEffect","WinEffect","LineSuperTileLogic","MaxBombSuperTileLogic","RadiusBombSuperTileLogic","SuperTile","SuperTileFactory","SuperTileLogic","SuperTileType","SuperTiles","BoardView","BoosterView","GameController","LoseView","MovesView","OverlayView","ScoreView","TileView","TileViewPool","WinView"]);